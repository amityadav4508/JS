<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resume Generator with PDF, Print & Live Preview</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- jsPDF and html2canvas libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    body {
      background-color: #f8f9fa;
    }

    h1,
    h4 {
      font-weight: bold;
    }

    .form-section {
      background-color: white;
      border-radius: 8px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);
      margin-bottom: 30px;
    }

    #cv-template {
      display: none;
      background-color: white;
      border-radius: 8px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      margin-top: 30px;
    }

    .cv-header {
      border-bottom: 2px solid #dee2e6;
      margin-bottom: 20px;
      padding-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .cv-name {
      font-size: 1.75rem;
      font-weight: 600;
    }

    .cv-pic {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #007bff;
    }

    .cv-section {
      margin-top: 20px;
    }

    .btn-primary,
    .btn-success {
      border-radius: 25px;
    }

    ul {
      padding-left: 20px;
    }

    .add-btn {
      margin-top: 10px;
    }

    .label-bold {
      font-weight: 500;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h1 class="text-center mb-4">Resume Generator</h1>

    <!-- Resume Form -->
    <div class="form-section">
      <div class="row">
        <!-- Left Column -->
        <div class="col-md-6">
          <h4>Personal Information</h4>
          <div class="mb-3">
            <label class="form-label">Full Name <span class="text-danger">*</span></label>
            <input
              id="nameField"
              type="text"
              class="form-control"
              placeholder="e.g. John Doe"
            />
          </div>
          <div class="mb-3">
            <label class="form-label">Contact <span class="text-danger">*</span></label>
            <input
              id="contactField"
              type="text"
              class="form-control"
              placeholder="e.g. +1234567890"
            />
          </div>
          <div class="mb-3">
            <label class="form-label">Address <span class="text-danger">*</span></label>
            <input
              id="addressField"
              type="text"
              class="form-control"
              placeholder="e.g. New York, USA"
            />
          </div>

          <div class="mb-3">
            <label class="form-label">Upload Profile Picture</label>
            <input
              id="profilePicInput"
              type="file"
              accept="image/*"
              class="form-control"
            />
          </div>

          <h5 class="mt-4">Social Links</h5>
          <div class="mb-3">
            <label class="form-label">Facebook</label>
            <input
              id="fbField"
              type="text"
              class="form-control"
              placeholder="Facebook profile link"
            />
          </div>
          <div class="mb-3">
            <label class="form-label">Instagram</label>
            <input
              id="instaField"
              type="text"
              class="form-control"
              placeholder="Instagram profile link"
            />
          </div>
          <div class="mb-3">
            <label class="form-label">LinkedIn</label>
            <input
              id="linkedinField"
              type="text"
              class="form-control"
              placeholder="LinkedIn profile link"
            />
          </div>
        </div>

        <!-- Right Column -->
        <div class="col-md-6">
          <h4>Professional Information</h4>
          <div class="mb-3">
            <label class="form-label">Career Objective <span class="text-danger">*</span></label>
            <textarea
              id="objectiveField"
              rows="4"
              class="form-control"
              placeholder="Brief career summary"
            ></textarea>
          </div>

          <!-- Work Experience -->
          <div class="mb-3" id="we">
            <label class="form-label">Work Experience <span class="text-danger">*</span></label>
            <textarea
              class="form-control weField"
              rows="3"
              placeholder="Enter work experience"
            ></textarea>
            <button
              type="button"
              class="btn btn-outline-primary btn-sm add-btn"
              onclick="addNewWorkEField()"
            >
              + Add More
            </button>
          </div>

          <!-- Academic Qualification -->
          <div class="mb-3" id="aq">
            <label class="form-label">Academic Qualification <span class="text-danger">*</span></label>
            <textarea
              class="form-control aqField"
              rows="3"
              placeholder="Enter academic qualification"
            ></textarea>
            <button
              type="button"
              class="btn btn-outline-primary btn-sm add-btn"
              onclick="addNewAqField()"
            >
              + Add More
            </button>
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <button id="generateBtn" class="btn btn-success btn-lg px-5">
          Generate CV
        </button>
      </div>

      <div class="text-center mt-3" style="display: flex; justify-content:center; gap: 15px;">
        <button id="printBtn" class="btn btn-outline-secondary">Print CV</button>
        <button id="pdfBtn" class="btn btn-outline-secondary">Download PDF</button>
      </div>
    </div>

    <!-- CV Preview Section -->
    <div id="cv-template">
      <div class="cv-header">
        <img
          id="profilePicPreview"
          src=""
          alt="Profile Picture"
          class="cv-pic"
          style="display:none"
        />
        <div>
          <div class="cv-name" id="nameT"></div>
          <div><span class="label-bold">Contact:</span> <span id="contactT"></span></div>
          <div><span class="label-bold">Address:</span> <span id="addressT"></span></div>
        </div>
      </div>

      <div class="cv-section">
        <h5>Objective</h5>
        <p id="objectiveT"></p>
      </div>

      <div class="cv-section">
        <h5>Work Experience</h5>
        <ul id="weT"></ul>
      </div>

      <div class="cv-section">
        <h5>Academic Qualifications</h5>
        <ul id="aqT"></ul>
      </div>

      <div class="cv-section">
        <h5>Social Profiles</h5>
        <p>
          <span class="label-bold">Facebook:</span>
          <span id="fbT"></span>
        </p>
        <p>
          <span class="label-bold">Instagram:</span>
          <span id="instaT"></span>
        </p>
        <p>
          <span class="label-bold">LinkedIn:</span>
          <span id="linkedinT"></span>
        </p>
      </div>
    </div>
  </div>

  <script>
    // Functions to add new textarea fields
    function addNewWorkEField() {
      const newNode = document.createElement("textarea");
      newNode.classList.add("form-control", "weField", "mt-2");
      newNode.setAttribute("rows", 3);
      newNode.setAttribute("placeholder", "Enter work experience");
      const weDiv = document.getElementById("we");
      weDiv.insertBefore(newNode, weDiv.querySelector(".add-btn"));
      newNode.addEventListener("input", livePreview);
    }

    function addNewAqField() {
      const newNode = document.createElement("textarea");
      newNode.classList.add("form-control", "aqField", "mt-2");
      newNode.setAttribute("rows", 3);
      newNode.setAttribute("placeholder", "Enter academic qualification");
      const aqDiv = document.getElementById("aq");
      aqDiv.insertBefore(newNode, aqDiv.querySelector(".add-btn"));
      newNode.addEventListener("input", livePreview);
    }

    document.addEventListener("DOMContentLoaded", () => {
      const generateBtn = document.getElementById("generateBtn");
      const printBtn = document.getElementById("printBtn");
      const pdfBtn = document.getElementById("pdfBtn");
      const cvTemplate = document.getElementById("cv-template");
      const profilePicInput = document.getElementById("profilePicInput");
      const profilePicPreview = document.getElementById("profilePicPreview");

      // Generate CV button handler
      generateBtn.addEventListener("click", () => {
        if (!validateForm()) return;

        updateCV();
        cvTemplate.style.display = "block";
        window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
      });

      // Print CV button handler
      printBtn.addEventListener("click", () => {
        const printWindow = window.open("", "", "width=800,height=600");
        printWindow.document.write(`
       
          <div>
            <title>Print CV</title>
            <style>
              body { font-family: Arial, sans-serif; margin: 20px; }
              .cv-header { border-bottom: 2px solid #dee2e6; margin-bottom: 20px; padding-bottom: 10px; display: flex; align-items: center; gap: 20px; }
              .cv-name { font-size: 1.75rem; font-weight: 600; }
              .cv-pic { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 2px solid #007bff; }
              .cv-section { margin-top: 20px; }
              ul { padding-left: 20px; }
              .label-bold { font-weight: 500; }
            </style>
          </div>
          <P>${cvTemplate.innerHTML}</P>
        
        `);
        printWindow.document.close();
        printWindow.focus();
        printWindow.print();
        printWindow.close();
      });

      // PDF Download button handler
      pdfBtn.addEventListener("click", () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF("p", "pt", "a4");
        const pdfWidth = doc.internal.pageSize.getWidth();
        const pdfHeight = doc.internal.pageSize.getHeight();

        html2canvas(cvTemplate, { scale: 2 }).then((canvas) => {
          const imgData = canvas.toDataURL("image/png");
          const imgProps = doc.getImageProperties(imgData);
          const imgWidth = pdfWidth;
          const imgHeight = (imgProps.height * imgWidth) / imgProps.width;
          let position = 0;

          if (imgHeight < pdfHeight) {
            doc.addImage(imgData, "PNG", 0, 0, imgWidth, imgHeight);
          } else {
            let heightLeft = imgHeight;
            while (heightLeft > 0) {
              doc.addImage(imgData, "PNG", 0, position, imgWidth, imgHeight);
              heightLeft -= pdfHeight;
              position -= pdfHeight;
              if (heightLeft > 0) doc.addPage();
            }
          }

          doc.save("resume.pdf");
        });
      });

      // Profile picture preview
      profilePicInput.addEventListener("change", () => {
        const file = profilePicInput.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            profilePicPreview.src = e.target.result;
            profilePicPreview.style.display = "block";
          };
          reader.readAsDataURL(file);
        }
      });

      // Validate required fields
      function validateForm() {
        const name = document.getElementById("nameField").value.trim();
        const contact = document.getElementById("contactField").value.trim();
        const address = document.getElementById("addressField").value.trim();
        const objective = document.getElementById("objectiveField").value.trim();

        if (!name || !contact || !address || !objective) {
          alert("Please fill out all required fields marked with *.");
          return false;
        }

        const weFields = document.querySelectorAll(".weField");
        if (![...weFields].some((field) => field.value.trim() !== "")) {
          alert("Please enter at least one Work Experience.");
          return false;
        }

        const aqFields = document.querySelectorAll(".aqField");
        if (![...aqFields].some((field) => field.value.trim() !== "")) {
          alert("Please enter at least one Academic Qualification.");
          return false;
        }

        return true;
      }

      // Update CV preview with form data
      function updateCV() {
        document.getElementById("nameT").textContent = document.getElementById("nameField").value.trim();
        document.getElementById("contactT").textContent = document.getElementById("contactField").value.trim();
        document.getElementById("addressT").textContent = document.getElementById("addressField").value.trim();
        document.getElementById("objectiveT").textContent = document.getElementById("objectiveField").value.trim();

        // Work Experience
        const weT = document.getElementById("weT");
        weT.innerHTML = "";
        const weFields = document.querySelectorAll(".weField");
        weFields.forEach((field) => {
          if (field.value.trim()) {
            const li = document.createElement("li");
            li.textContent = field.value.trim();
            weT.appendChild(li);
          }
        });

        // Academic Qualification
        const aqT = document.getElementById("aqT");
        aqT.innerHTML = "";
        const aqFields = document.querySelectorAll(".aqField");
        aqFields.forEach((field) => {
          if (field.value.trim()) {
            const li = document.createElement("li");
            li.textContent = field.value.trim();
            aqT.appendChild(li);
          }
        });

        // Social links clickable if valid
        const fb = document.getElementById("fbField").value.trim();
        const insta = document.getElementById("instaField").value.trim();
        const linkedin = document.getElementById("linkedinField").value.trim();

        document.getElementById("fbT").innerHTML = isValidURL(fb)
          ? `<a href="${fb}" target="_blank" rel="noopener noreferrer">${fb}</a>`
          : "N/A";
        document.getElementById("instaT").innerHTML = isValidURL(insta)
          ? `<a href="${insta}" target="_blank" rel="noopener noreferrer">${insta}</a>`
          : "N/A";
        document.getElementById("linkedinT").innerHTML = isValidURL(linkedin)
          ? `<a href="${linkedin}" target="_blank" rel="noopener noreferrer">${linkedin}</a>`
          : "N/A";
      }

      // URL validation helper
      function isValidURL(str) {
        try {
          const url = new URL(str);
          return url.protocol === "http:" || url.protocol === "https:";
        } catch {
          return false;
        }
      }

      // Live preview on input
      function livePreview() {
        if (cvTemplate.style.display === "block") {
          updateCV();
        }
      }

      // Attach live preview to all input and textarea fields
      document.querySelectorAll("input, textarea").forEach((input) => {
        input.addEventListener("input", livePreview);
      });
    });
  </script>
</body>
</html>
